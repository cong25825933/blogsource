---
title: (译) O(ND)字符串差异算法
date: 2016-11-07 09:52:32
categories:
tags: [algorithm]
cover: http://imglf1.nosdn.127.net/img/K1VGeEFFWE1kVEtIRklrMjlVS3VCMkFMNWRiNkhZTlBPTG03dXNIVVc1aFUzYTBJenQ3THJRPT0.jpg?imageView&thumbnail=800x0&quality=96&stripmeta=0&type=jpg
---

作者： 亚利桑那大学计算机科学系，EUGENE W.MYERS

众所周知，寻找最长公共子串问题(LCS)与最短编辑脚本问题(SES)是对偶问题。在这篇论文中，他们将被认为在编辑图中寻找最短/最长路径是等价问题。在这个视角看该问题，O(ND)时间空间复杂度的算法就出现了，N表示A串、B串的长度之和，D表示A、B的最小编辑脚本。该算法在A、B串差异不大的时候效率很好(D很小)。该算法在一般随机的情况下，有O(N+D²)的预计时间效率和O(N)的空间复杂度，如果使用前缀树的话，时间复杂度可以优化至O(NlgN+D²).

关键词：  
最长公共子串；最短编辑脚本(LCS)；编辑图(SES)；文件比对

## 引言

两个字符串差异问题已经在其他的文献中有过学习[1,8,11,13,16,19,20]。应用该算法的应用有许多，包括拼写校对系统，文件比对工具，基因演化的研究[4,5,17,18]。进入正题，寻找最长公共子串的问题等价于最短编辑脚本(A串通过若干插入和删除操作变为B串的操作数)。其中最早的算法是来自Wagner和Fischer的"串串"校对问题，需要O(N²)的时空复杂度。之后是来自Hirschberg的优化，只需要O(N)线性空间复杂度[7]。当差异算法是基于相等不相等的比较操作，则被认为Ω(N²)是必须的[1]。随后有四位俄罗斯人做出了略微地优化，将时间复杂度降至O(N²lglgN/lgN)和O(N²/lgN)，分别对应随机字母情况和有限字母情况。当然还存在更快的基于其他比较操作算法，事实上，使用"<=" "=" ">="比较操作的算法，Ω(NlgN)时间复杂度是最佳的。

最近有研究提升了随机字母情况的O(N²)算法，使得该问题效率对另一个参数敏感。假设输出参数L为最长公共子序列长度，那么对应的对偶参数D = 2*(N-L)，表示最短编辑脚本长度。(在引言中，假定A、B串长都为N) 有两个来自Hirschberg输出敏感算法，分别需要O(NL+NlgN) 和 O(DLlgN) 时间复杂度。还有一种来自Hunt和Szymanski的O((R+N)lgN)算法，R表示AB串相等的位置个数。

在实际情况下，通常参数D比较小。比如程序员想要知道他们曾经对于文本文件的修改。生物学家想知道DNA的突变情况。对于这些情况，O(ND)算法更优于Hirschberg的算法，因为当D比较小的时候，L需要O(N)时间才能求出。

在这篇论文中将给出一个O(ND)时间复杂度的算法。我们的算法简单，并且基于便于理解的编辑图。它利用“贪心”的设计范例，表现了最长公共子序列到单源最短路径的关系。一个其他的O(ND)算法在其他地方被提出来[16]。然而，它使用的是不同的贪心策略，而且也没有提出什么相关的特性。该算法可以优化至线性空间复杂度。


## 编辑图

设A=a1a2a3...aN, B=b1b2b3...bM, len(A)=N,len(B)=M，则AB的编辑图就是x∈[0,N], y∈[0,M]，组成的一个二维网格图。编辑图的顶点可以通过有向无环图的水平，垂直，斜线边连接。水平边如(x-1,y)->(x,y), x∈[1,N], y∈[0,M]. 垂直边如(x,y-1)->(x,y), x∈[0,N] y∈[1,M]. 如果ax=by，则存在斜边(x-1,y-1)->(x,y), 像这样的点(x,y)被叫做“配对点”。配对点的总数就是Hunt&Szymanski算法中的相关参数R，也就是编辑图中的斜边个数。图1描绘了串A"abcabba"和串B"cbabac"的编辑图。
![ClipboardImage](/upload/1478523439810.png)
<center>图一：编辑图</center>

L的痕迹(trace)是L个配对点的序列，也就是xi<x(i+1)并且yi<y(i+1)。每一个痕迹都准确地配对从(0,0)到(N,M)的斜边。在从起点到终点遍历的过程中，trace就被标记出来了。注释：L就是从起点到终点的斜边个数。如图，(0,0)到(N,M)的路径有很多，但痕迹是路径的子集。

A和B的编辑脚本是将A转换为B的插入和删除操作的集合。"xD"表示删除ax，"xIb1,b2,...bt"表示在ax之后插入b1,b2,...,bt。这些操作是同时进行的。脚本的长度就是插入和删除字符的个数。

显而易见，将A转变为B，需要删除N-L个字符，插入M-L个字符，所以编辑脚本的长度D=N+M-2L。 所以公共子串问题，编辑脚本问题，痕迹问题，(0,0)到(N,M)路径问题都是同一类问题。路径上的水平和垂直线就是对应删除插入操作。最长公共子序列问题就是寻找(0,0)到(N,M)具有最多斜边数目的路径；最小编辑脚本问题就是寻找(0,0)到(N,M)具有最少非斜边数目的路径，显然这是一对对偶问题。

## O((M+N)*D)的贪心算法
定义D-Path表示从(0,0)开始有D条非斜边的路径。一般来看，D-Path是由(D-1)-Path加上一条非斜边组成的。特殊地，又将无斜边的路径称为snake。









